<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Individual Assessment - Market Knowledge</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Define custom colors as CSS variables or direct classes for Tailwind compatibility */
        :root {
            --dark-black-base: #1a202c; /* Original dark background */
            --dark-black-light: #252932; /* Deep dark background for main section cards */
            --dark-black-lighter: #2c313c; /* Darker grey, used in gradients for career path and inner cards */
            --dark-black-lightest: #3a404a; /* Dark grey, used in gradients for career path and inner cards */
            --baby-pink: #fbcfe8; /* Pink-300 */
            --lighter-baby-pink: #FFB3C6; /* A slightly lighter pink for gradients */
            --off-white-text: #e2e8f0; /* Off-white for headings and text */
            --light-grey-text: #cbd5e0; /* Light grey for paragraphs */
        }

        /* Custom background: Dark Black */
        body {
            font-family: 'Inter', sans-serif;
            overflow-x: hidden; /* Prevent horizontal scroll due to animations */
            background-color: var(--dark-black-base);
            padding: 2.5rem 1.5rem; /* Increased padding */
            box-sizing: border-box;
            color: var(--off-white-text); /* Off-white for general text on dark background */
            display: flex; /* Added for centering */
            justify-content: center; /* Center horizontally */
            align-items: center; /* Center vertically */
            min-height: 100vh; /* Ensure it takes full viewport height */
        }

        /* Custom scrollbar for better aesthetics */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: var(--dark-black-lightest); /* Darker track */
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: var(--baby-pink); /* Baby Pink thumb */
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: var(--lighter-baby-pink); /* Slightly lighter pink on hover */
        }

        /* Custom styles for the main container */
        .container {
            background-color: var(--dark-black-light); /* Deep dark background for the main card */
            border-radius: 1.5rem; /* More rounded corners */
            box-shadow: 0 15px 30px rgba(0,0,0,0.5); /* Stronger shadow */
            padding: 3rem; /* Increased padding */
            max-width: 950px; /* Increased max-width for more content space */
            width: 100%;
            animation: fadeInScale 0.8s ease-out forwards; /* Initial fade-in animation */
            position: relative; /* For z-index of popup */
            color: var(--off-white-text); /* Off-white text inside the dark container */
            border: 2px solid transparent;
            border-image: linear-gradient(to right, var(--baby-pink), var(--lighter-baby-pink)) 1; /* Baby Pink gradient border */
        }

        /* Fade-in and scale animation for the main container */
        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.95) translateY(30px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        /* Button hover and active effects */
        .btn-primary, .btn-secondary {
            transition: all 0.3s ease; /* Smooth transitions for all properties */
            position: relative;
            overflow: hidden;
            z-index: 1;
            font-weight: 700; /* Bolder text */
            letter-spacing: 0.05em; /* Slightly spaced out letters */
        }
        .btn-primary:hover, .btn-secondary:hover {
            transform: translateY(-5px); /* Lift effect on hover */
            box-shadow: 0 12px 20px rgba(0, 0, 0, 0.4); /* Slightly softer shadow on hover */
        }
        .btn-primary:active, .btn-secondary:active {
            transform: translateY(0); /* Press effect on click */
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2); /* Softer shadow on press */
        }
        /* Ripple effect on buttons */
        .ripple {
            position: absolute;
            border-radius: 50%;
            transform: scale(0);
            animation: ripple-effect 0.6s linear;
            background-color: rgba(255, 255, 255, 0.7); /* White ripple */
            pointer-events: none; /* Make sure it doesn't interfere with clicks */
        }
        @keyframes ripple-effect {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }

        /* Styles for input fields */
        input[type="text"], input[type="email"] {
            transition: all 0.3s ease;
            border-radius: 0.75rem; /* More rounded inputs */
            border: 1px solid var(--dark-black-lightest); /* Dark grey border */
            padding: 0.85rem 1.25rem; /* Slightly more padding */
            background-color: var(--dark-black-lighter); /* Darker grey input background */
            color: var(--off-white-text); /* Off-white text */
        }
        input[type="text"]:focus, input[type="email"]:focus {
            border-color: var(--baby-pink); /* Baby Pink on focus */
            box-shadow: 0 0 0 4px rgba(255, 192, 203, 0.3); /* Soft Baby Pink glow on focus */
            outline: none;
        }

        /* Styles for radio buttons */
        input[type="radio"] {
            accent-color: var(--baby-pink); /* Baby Pink for selected radio button */
            transform: scale(1.2); /* Slightly larger radio button */
            transition: transform 0.2s ease;
        }
        input[type="radio"]:hover {
            transform: scale(1.3);
        }

        /* Alert/Popup styling */
        .alert-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0); /* Start scaled down */
            transform-origin: center;
            background-color: var(--dark-black-light); /* Deep dark background for alert */
            color: var(--baby-pink); /* Pink-300 text */
            padding: 1.8rem 2.5rem; /* Larger padding */
            border-radius: 1.25rem; /* More rounded */
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55); /* Springy animation */
            text-align: center;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 1.2rem; /* Increased gap */
            font-size: 1.2rem; /* Larger font size */
            border: 2px solid var(--baby-pink); /* Pink-300 border */
        }
        .alert-popup.show {
            transform: translate(-50%, -50%) scale(1); /* Scale up to normal size */
            opacity: 1;
        }
        .alert-popup .close-btn {
            background: none;
            border: none;
            color: var(--baby-pink); /* Pink-300 close button */
            font-size: 1.8rem; /* Larger close button */
            cursor: pointer;
            position: absolute;
            top: 0.8rem;
            right: 1rem;
            transition: transform 0.2s ease;
        }
        .alert-popup .close-btn:hover {
            transform: rotate(90deg);
        }

        /* Animation for score result section */
        #scoreResultDiv {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.9s ease-out, transform 0.9s ease-out;
        }
        #scoreResultDiv.show {
            opacity: 1;
            transform: translateY(0);
        }

        /* Custom styling for the WhatsApp button */
        #whatsappTrainerButton {
            background: linear-gradient(to right, var(--baby-pink), var(--lighter-baby-pink)); /* Baby Pink gradient */
            color: var(--dark-black-base); /* Dark text for contrast */
            padding: 0.9rem 1.8rem; /* Larger padding */
            border-radius: 0.9rem; /* More rounded */
            font-weight: 700;
            display: inline-flex;
            align-items: center;
            gap: 0.6rem;
            transition: background-color 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease;
        }
        #whatsappTrainerButton:hover {
            background: linear-gradient(to right, var(--lighter-baby-pink), var(--baby-pink)); /* Darker pink on hover */
            transform: translateY(-3px);
            box-shadow: 0 8px 15px rgba(255, 192, 203, 0.4);
        }
        #whatsappTrainerButton:active {
            transform: translateY(0);
            box-shadow: 0 4px 8px rgba(255, 192, 203, 0.2);
        }

        /* Timer styling */
        #timerDisplay {
            font-size: 1.8rem; /* Smaller font size */
            font-weight: bold;
            color: var(--dark-black-base); /* Dark text for contrast */
            background: linear-gradient(45deg, var(--baby-pink), var(--lighter-baby-pink)); /* Baby Pink to Lighter Baby Pink gradient */
            padding: 0.8rem 1.5rem; /* Smaller padding */
            border-radius: 1.2rem; /* Adjusted border-radius */
            border: 3px solid var(--baby-pink); /* Baby Pink border */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2); /* Slightly softer shadow */
            margin-bottom: 1.5rem; /* Adjusted margin */
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.8rem; /* Smaller gap */
            animation: pulsePink 2s infinite alternate; /* Gentle pulsing animation */
        }
        #timerDisplay.time-critical {
            color: var(--dark-black-base); /* Dark text */
            background: linear-gradient(45deg, var(--lighter-baby-pink), var(--baby-pink)); /* Lighter Baby Pink to Baby Pink gradient for critical */
            border-color: var(--baby-pink); /* Baby Pink border */
            animation: pulseCriticalPink 0.8s infinite alternate; /* Faster pulsing when critical */
        }

        @keyframes pulsePink {
            from { transform: scale(1); box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2); }
            to { transform: scale(1.01); box-shadow: 0 5px 12px rgba(0, 0, 0, 0.25); }
        }

        @keyframes pulseCriticalPink {
            from { transform: scale(1); background: linear-gradient(45deg, var(--lighter-baby-pink), var(--baby-pink)); }
            to { transform: scale(1.02); background: linear-gradient(45deg, var(--baby-pink), var(--lighter-baby-pink)); }
        }

        /* Styling for the Company Name Heading */
        .company-name-heading {
            position: relative;
            padding-bottom: 0.75rem; /* Space for the underline */
            margin-bottom: 2rem; /* More space below */
            font-size: 2.5rem; /* Larger font size for prominence */
            font-weight: 800; /* Extra bold */
            color: var(--off-white-text); /* Off-white text color for company name */
            text-shadow: 0 0 10px rgba(255, 192, 203, 0.2); /* Subtle pink glow */
        }

        .company-name-heading::after {
            content: '';
            position: absolute;
            left: 50%; /* Center the underline */
            transform: translateX(-50%);
            bottom: 0;
            width: 100px; /* Length of the underline */
            height: 5px; /* Thickness of the underline */
            background: linear-gradient(to right, var(--baby-pink), var(--lighter-baby-pink)); /* Baby Pink gradient underline */
            border-radius: 2.5px; /* Rounded ends for the underline */
        }

        /* Styling for question cards */
        .question-card {
            background: linear-gradient(to bottom, var(--dark-black-lighter), var(--dark-black-light)); /* Subtle dark gradient for question cards */
            border: 1px solid rgba(255, 192, 203, 0.3); /* Slightly more visible pink border */
            border-radius: 1rem; /* Consistent rounded corners */
            padding: 1.5rem; /* Increased padding */
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            color: var(--off-white-text); /* Off-white text for questions */
        }
        .question-card label {
            color: var(--light-grey-text); /* Slightly lighter grey for options */
        }
        .question-card label:hover {
            background-color: var(--dark-black-lightest); /* Darker grey hover background for options */
        }

        /* Score result section styling */
        #scoreResultDiv {
            background: linear-gradient(to right, var(--dark-black-lighter), var(--dark-black-light)); /* Darker gradient background */
            border: 1px solid rgba(255, 192, 203, 0.1); /* Subtle pink border */
            border-radius: 1rem; /* Rounded corners */
            padding: 2.5rem; /* Increased padding */
            box-shadow: 0 10px 20px rgba(0,0,0,0.4); /* More pronounced shadow */
            color: var(--off-white-text); /* Off-white text */
        }
        #scoreResultDiv h2 {
            color: var(--baby-pink); /* Baby Pink for score heading */
            text-shadow: 0 0 10px rgba(255, 192, 203, 0.2); /* Subtle glow */
        }
        #scoreResultDiv p {
            color: var(--lighter-baby-pink); /* Lighter Baby Pink for score display */
        }
        #scoreResultDiv .review-item {
            background-color: var(--dark-black-lightest); /* Darker grey background for review items */
            border: 1px solid rgba(255, 192, 203, 0.4); /* Baby Pink border */
            color: var(--off-white-text); /* Off-white text */
        }
        /* Correct and Incorrect review items now use pink borders and dark backgrounds */
        #scoreResultDiv .review-item.correct {
            border-color: var(--baby-pink); /* Baby Pink border for correct */
            background-color: var(--dark-black-lighter); /* Slightly different dark for correct */
        }
        #scoreResultDiv .review-item.incorrect {
            border-color: var(--lighter-baby-pink); /* Lighter Baby Pink border for incorrect */
            background-color: var(--dark-black-lighter); /* Slightly different dark for incorrect */
        }
        /* Ensure specific text within review items is visible and matches theme */
        #scoreResultDiv .review-item p,
        #scoreResultDiv .review-item span {
            color: var(--off-white-text); /* Ensure text is off-white */
        }
        #scoreResultDiv .review-item span.correct-answer-text { /* Custom class for correct answer text */
            color: var(--baby-pink); /* Now Baby Pink */
        }
        #scoreResultDiv .review-item span.incorrect-answer-text { /* Custom class for incorrect answer text */
            color: var(--lighter-baby-pink); /* Now Lighter Baby Pink */
        }


        /* Responsive adjustments */
        @media (max-width: 768px) {
            .container {
                padding: 2rem;
                margin: 0.5rem;
            }
            body {
                padding: 1rem 0.5rem;
            }
            #timerDisplay {
                font-size: 1.5rem; /* Even smaller on mobile */
                padding: 0.6rem 1rem;
                gap: 0.6rem;
            }
            h1 {
                font-size: 2.5rem; /* Smaller heading on mobile */
            }
            .company-name-heading {
                font-size: 1.8rem; /* Smaller company name on mobile */
            }
            .company-name-heading::after {
                width: 80px; /* Shorter underline on mobile */
            }
            .text-xl {
                font-size: 1.1rem;
            }
            .text-lg {
                font-size: 1rem;
            }
        }
        @media (max-width: 480px) {
            .container {
                padding: 1.5rem;
            }
            h1 {
                font-size: 2rem;
            }
            .text-5xl {
                font-size: 3rem; /* Smaller score on small screens */
            }
            .btn-primary, .btn-secondary {
                padding: 0.75rem 1.25rem;
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Company Name Styling - Moved to the very top -->
        <h2 class="text-center company-name-heading">
            OnePaper Research Analysts Private Limited
        </h2>

        <h1 class="text-4xl font-extrabold text-center mb-2 flex items-center justify-center gap-3">
            <i class="fas fa-brain" style="color: var(--baby-pink);"></i> Individual Assessment
        </h1>
        <p class="text-xl text-center mb-1" style="color: var(--light-grey-text);">Market Knowledge</p>


        <!-- User Information Section -->
        <div id="userInfoSection" class="p-6 rounded-lg shadow-inner mb-8" style="background-color: var(--dark-black-lighter);">
            <h2 class="text-2xl font-semibold mb-4" style="color: var(--baby-pink);">Your Details</h2>
            <div class="mb-4">
                <label for="userName" class="block text-lg font-medium mb-2" style="color: var(--light-grey-text);">Your Name:</label>
                <input type="text" id="userName" name="userName" placeholder="Enter your full name"
                       class="w-full p-3 border rounded-lg focus:outline-none focus:ring-4"
                       style="border-color: var(--dark-black-lightest); background-color: var(--dark-black-lighter); color: var(--off-white-text); --tw-ring-color: rgba(255, 192, 203, 0.3);" required>
            </div>
            <div class="mb-4">
                <label for="userEmail" class="block text-lg font-medium mb-2" style="color: var(--light-grey-text);">Your Email:</label>
                <input type="email" id="userEmail" name="userEmail" placeholder="Enter your email address"
                       class="w-full p-3 border rounded-lg focus:outline-none focus:ring-4"
                       style="border-color: var(--dark-black-lightest); background-color: var(--dark-black-lighter); color: var(--off-white-text); --tw-ring-color: rgba(255, 192, 203, 0.3);" required>
            </div>
            <button id="startAssessmentButton"
                    class="btn-primary w-full py-3 rounded-lg text-xl font-bold focus:outline-none focus:ring-4"
                    style="background: linear-gradient(to right, var(--baby-pink), var(--lighter-baby-pink)); color: var(--dark-black-base); --tw-ring-color: rgba(255, 192, 203, 0.3);">
                Start Assessment <i class="fas fa-play ml-2"></i>
            </button>
        </div>

        <!-- Assessment Section (Initially hidden) -->
        <div id="assessmentSection" class="hidden">
            <!-- Timer Display -->
            <div id="timerDisplay" class="hidden">
                <i class="fas fa-hourglass-half"></i> <span id="timeRemaining">20:00</span>
            </div>

            <form id="assessmentForm" class="space-y-8">
                <!-- Single question will be dynamically inserted here -->
            </form>

            <div class="flex justify-between mt-8">
                <button type="button" id="prevQuestionButton"
                        class="btn-secondary py-3 px-6 rounded-lg text-xl font-bold focus:outline-none focus:ring-4 disabled:opacity-50 disabled:cursor-not-allowed"
                        style="background-color: var(--dark-black-lightest); color: var(--off-white-text); --tw-ring-color: rgba(255, 192, 203, 0.3);">
                    <i class="fas fa-arrow-left mr-2"></i> Previous
                </button>
                <button type="button" id="nextQuestionButton"
                        class="btn-primary py-3 px-6 rounded-lg text-xl font-bold focus:outline-none focus:ring-4"
                        style="background: linear-gradient(to right, var(--baby-pink), var(--lighter-baby-pink)); color: var(--dark-black-base); --tw-ring-color: rgba(255, 192, 203, 0.3);">
                    Next <i class="fas fa-arrow-right ml-2"></i>
                </button>
                <button type="submit" id="submitAssessmentButton"
                        class="btn-primary py-3 px-6 rounded-lg text-xl font-bold focus:outline-none focus:ring-4 hidden"
                        style="background: linear-gradient(to right, var(--baby-pink), var(--lighter-baby-pink)); color: var(--dark-black-base); --tw-ring-color: rgba(255, 192, 203, 0.3);">
                    Submit Assessment <i class="fas fa-paper-plane ml-2"></i>
                </button>
            </div>
        </div>

        <!-- Score Result Section (Initially hidden) -->
        <div id="scoreResultDiv" class="hidden p-6 rounded-lg shadow-inner mt-8 text-center"
             style="background: linear-gradient(to right, var(--dark-black-lighter), var(--dark-black-base)); border: 1px solid rgba(255, 192, 203, 0.1);">
            <h2 class="text-3xl font-bold mb-4 flex items-center justify-center gap-3" style="color: var(--baby-pink);">
                <i class="fas fa-award" style="color: var(--baby-pink);"></i> Your Score
            </h2>
            <p class="text-5xl font-extrabold mb-6" style="color: var(--lighter-baby-pink);" id="scoreDisplay">0/0</p>
            <div class="text-left mb-6">
                <h3 class="text-2xl font-semibold mb-3" style="color: var(--baby-pink);">Review Your Answers:</h3>
                <div id="answerReview" class="space-y-4">
                    <!-- Reviewed answers will be inserted here -->
                </div>
            </div>
            <button id="whatsappTrainerButton"
                    class="mt-6">
                <i class="fab fa-whatsapp"></i> Share with Trainer via WhatsApp
            </button>
        </div>
    </div>

    <!-- Custom Alert/Popup Container -->
    <div id="customAlert" class="alert-popup hidden">
        <i class="fas fa-check-circle text-3xl"></i>
        <span id="alertMessage" class="text-xl"></span>
        <button class="close-btn" onclick="hideAlert()">&times;</button>
    </div >

    <script>
        // Array of assessment questions (Updated to 20 questions from SET-2.docx)
        const questions = [
            {
                questionText: "What is the full form of SEBI",
                name: "q1",
                options: [
                    "Security and Exchange Board of India",
                    "Securities and Exchange Board of India",
                    "State and Exchange Board of India",
                    "Securities and Election Board of India"
                ],
                correctAnswer: "Securities and Exchange Board of India"
            },
            {
                questionText: "Meaning of Equity",
                name: "q2",
                options: [
                    "Ownership of Shares only",
                    "Ownership of the whole Company",
                    "Ownership of a Stock in a Company"
                ],
                correctAnswer: "Ownership of a Stock in a Company"
            },
            {
                questionText: "What is the lot size of Nifty 50?",
                name: "q3",
                options: [
                    "50",
                    "100",
                    "75",
                    "25"
                ],
                correctAnswer: "75"
            },
            {
                questionText: "Full form of CRM",
                name: "q4",
                options: [
                    "customer relationship management",
                    "customer relationship manager",
                    "custom relationship management",
                    "customer risk management"
                ],
                correctAnswer: "customer relationship management"
            },
            {
                questionText: "Identify the false statement.",
                name: "q5",
                options: [
                    "Futures contracts trade on a financial exchange.",
                    "Futures contracts are marked to market.",
                    "Futures contracts allow fewer delivery options than forward contracts.",
                    "Futures contracts are more liquid than forward contracts."
                ],
                correctAnswer: "Futures contracts allow fewer delivery options than forward contracts."
            },
            {
                questionText: "A put option with a strike price of Rs. 1176 is trading at a premium of Rs. 36. What will be the price at which it will break even for the buyer of the option?",
                name: "q6",
                options: [
                    "Rs. 1212",
                    "Rs. 1194",
                    "Rs. 1140",
                    "Rs. 1176"
                ],
                correctAnswer: "Rs. 1140"
            },
            {
                questionText: "What details would you find in the service agreement contract?",
                name: "q7",
                options: [
                    "Customer details, Service details, Sebi regulations, Terms & Conditions.",
                    "Customer details, Service details, Company details, Terms & Conditions",
                    "Customer details, Service details, Sebi regulations, Sebi Circular."
                ],
                correctAnswer: "Customer details, Service details, Company details, Terms & Conditions"
            },
            {
                questionText: "An open position in the options market exists only for",
                name: "q8",
                options: [
                    "long calls",
                    "long puts",
                    "short calls and long puts",
                    "long position and short position in both calls and puts"
                ],
                correctAnswer: "long position and short position in both calls and puts"
            },
            {
                questionText: "Buy ITC from 1200 with SL and Target of 1%?\nWhat is the SL and Target",
                name: "q9",
                options: [
                    "Target 1212, SL 1188",
                    "Target 1201, SL 1199",
                    "Target 1220, SL1180",
                    "Target 1112, SL 1188"
                ],
                correctAnswer: "Target 1212, SL 1188"
            },
            {
                questionText: "A speculator with a bullish view on a security can",
                name: "q10",
                options: [
                    "buy stock futures",
                    "buy index futures",
                    "sell stock futures",
                    "sell index futures"
                ],
                correctAnswer: "buy stock futures"
            },
            {
                questionText: "A Person wants to Buy 5 lot RELIANCE 2500 CALL, MAR contract at Rs.25.\nWhat is the investment require for this? (L-500)",
                name: "q11",
                options: [
                    "60,500",
                    "62,000",
                    "65000",
                    "62,500"
                ],
                correctAnswer: "62,500"
            },
            {
                questionText: "Ratan has Rs. 50,000 in his Demart account. Ratan wants to buy NIFTY 25100(24 JUL) CALL at Rs. 180.Current market price of NIFTY is 25090.Howmany lots he can Buy?",
                name: "q12",
                options: [
                    "4",
                    "5",
                    "3",
                    "2"
                ],
                correctAnswer: "3"
            },
            {
                questionText: "Bank Nifty 56800(JUL)CALL position will expire on",
                name: "q13",
                options: [
                    "Thursday of last week",
                    "Friday of last week",
                    "Thursday of first week",
                    "Thursday of every week"
                ],
                correctAnswer: "Thursday of last week"
            },
            {
                questionText: "If customer has taken put position in option, then for profit it's should",
                name: "q14",
                options: [
                    "go up",
                    "go down"
                ],
                correctAnswer: "go down"
            },
            {
                questionText: "Lot size of crude Oil",
                name: "q15",
                options: [
                    "1000",
                    "500",
                    "100",
                    "30"
                ],
                correctAnswer: "100"
            },
            {
                questionText: "Is it permissible to tell a customer that our recommendations will ensure that their losses are recovered.",
                name: "q16",
                options: [
                    "Yes",
                    "No"
                ],
                correctAnswer: "No"
            },
            {
                questionText: "Can Mr. A buy a HUL (Dec ) future contract in the month of September?",
                name: "q17",
                options: [
                    "Yes",
                    "No"
                ],
                correctAnswer: "No"
            },
            {
                questionText: "Service Agreement has to Sign within ___ days",
                name: "q18",
                options: [
                    "Mandatorily on same day as date of payment.",
                    "Within 1 monthsâ€™ time.",
                    "Same day as date of payment but can be done in a couple of days in exceptional situations.",
                    "After service tenure of client has ended."
                ],
                correctAnswer: "Same day as date of payment but can be done in a couple of days in exceptional situations."
            },
            {
                questionText: "The process of issuing share of a private company to the public is called as:",
                name: "q19",
                options: [
                    "Right issue",
                    "Bonus issue",
                    "Initial Public Offer",
                    "Company issue"
                ],
                correctAnswer: "Initial Public Offer"
            },
            {
                questionText: "In which module you can send bank details to the customer",
                name: "q20",
                options: [
                    "Lead Module",
                    "Deal Module",
                    "Quotation Module",
                    "Sales-Order Module."
                ],
                correctAnswer: "Deal Module"
            }
        ];

        // Get DOM elements
        const userInfoSection = document.getElementById('userInfoSection');
        const assessmentSection = document.getElementById('assessmentSection');
        const assessmentForm = document.getElementById('assessmentForm');
        const startAssessmentButton = document.getElementById('startAssessmentButton');
        const submitAssessmentButton = document.getElementById('submitAssessmentButton');
        const scoreResultDiv = document.getElementById('scoreResultDiv');
        const scoreDisplay = document.getElementById('scoreDisplay');
        const answerReview = document.getElementById('answerReview');
        const userNameInput = document.getElementById('userName');
        const userEmailInput = document.getElementById('userEmail');
        const whatsappTrainerButton = document.getElementById('whatsappTrainerButton');

        // New elements for timer and navigation
        const timerDisplay = document.getElementById('timerDisplay');
        const timeRemainingSpan = document.getElementById('timeRemaining');
        const prevQuestionButton = document.getElementById('prevQuestionButton');
        const nextQuestionButton = document.getElementById('nextQuestionButton');

        // Custom Alert/Popup elements
        const customAlert = document.getElementById('customAlert');
        const alertMessage = document.getElementById('alertMessage');

        let currentQuestionIndex = 0;
        let timeLeft = 20 * 60; // Changed to 20 minutes in seconds
        let timerInterval;
        const userAnswers = {}; // Store user answers for all questions

        // Function to show custom alert
        function showAlert(message) {
            alertMessage.textContent = message;
            customAlert.classList.remove('hidden');
            customAlert.classList.add('show');
            // Automatically hide after 3 seconds
            setTimeout(() => {
                hideAlert();
            }, 3000);
        }

        // Function to hide custom alert
        function hideAlert() {
            customAlert.classList.remove('show');
            customAlert.classList.add('hidden');
        }

        // Function to update timer display
        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            timeRemainingSpan.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

            if (timeLeft <= 60) { // Less than or equal to 1 minute remaining
                timerDisplay.classList.add('time-critical');
            } else {
                timerDisplay.classList.remove('time-critical');
            }
        }

        // Function to start the timer
        function startTimer() {
            timerDisplay.classList.remove('hidden');
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();

                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    showAlert("Time's up! Your assessment has been automatically submitted.");
                    submitAssessment(true); // Auto-submit when time runs out
                }
            }, 1000);
        }

        // Function to render a single question
        function renderQuestion() {
            assessmentForm.innerHTML = ''; // Clear previous question
            const q = questions[currentQuestionIndex];
            const questionDiv = document.createElement('div');
            // Apply new question card styling
            questionDiv.className = 'question-card p-6 rounded-lg shadow-md mb-8';
            questionDiv.innerHTML = `
                <p class="text-xl font-semibold mb-4" style="color: var(--off-white-text);">${currentQuestionIndex + 1}. ${q.questionText}</p>
                <div class="space-y-3">
                    ${q.options.map(option => `
                        <label class="flex items-center p-3 rounded-md cursor-pointer transition-colors duration-200" style="color: var(--light-grey-text); background-color: var(--dark-black-lightest);">
                            <input type="radio" name="${q.name}" value="${option}" class="form-radio h-5 w-5 mr-3" style="accent-color: var(--baby-pink);" ${userAnswers[q.name] === option ? 'checked' : ''}>
                            <span class="text-lg">${option}</span>
                        </label>
                    `).join('')}
                </div>
            `;
            assessmentForm.appendChild(questionDiv);

            // Update button visibility
            prevQuestionButton.disabled = currentQuestionIndex === 0;
            nextQuestionButton.classList.toggle('hidden', currentQuestionIndex === questions.length - 1);
            submitAssessmentButton.classList.toggle('hidden', currentQuestionIndex !== questions.length - 1);
        }

        // Function to check if the current question is answered
        function isCurrentQuestionAnswered() {
            const currentQuestion = questions[currentQuestionIndex];
            const selectedOption = document.querySelector(`input[name="${currentQuestion.name}"]:checked`);
            return selectedOption !== null;
        }

        // Event listener for Start Assessment button
        startAssessmentButton.addEventListener('click', () => {
            const userName = userNameInput.value.trim();
            const userEmail = userEmailInput.value.trim();

            if (userName && userEmail) {
                userInfoSection.classList.add('hidden');
                assessmentSection.classList.remove('hidden');
                renderQuestion(); // Render the first question
                startTimer(); // Start the timer
                showAlert("Assessment Started! Good luck!");
            } else {
                showAlert("Please enter your name and email to start the assessment.");
            }
        });

        // Event listener for Previous Question button
        prevQuestionButton.addEventListener('click', () => {
            if (currentQuestionIndex > 0) {
                // Save current answer before moving
                const currentQuestion = questions[currentQuestionIndex];
                const selectedOption = document.querySelector(`input[name="${currentQuestion.name}"]:checked`);
                if (selectedOption) {
                    userAnswers[currentQuestion.name] = selectedOption.value;
                } else {
                    // If user navigates back and removes an answer, ensure it's removed from userAnswers
                    delete userAnswers[currentQuestion.name];
                }

                currentQuestionIndex--;
                renderQuestion();
            }
        });

        // Event listener for Next Question button
        nextQuestionButton.addEventListener('click', () => {
            if (isCurrentQuestionAnswered()) {
                // Save current answer before moving
                const currentQuestion = questions[currentQuestionIndex];
                const selectedOption = document.querySelector(`input[name="${currentQuestion.name}"]:checked`);
                userAnswers[currentQuestion.name] = selectedOption.value;

                if (currentQuestionIndex < questions.length - 1) {
                    currentQuestionIndex++;
                    renderQuestion();
                }
            } else {
                showAlert("Please answer the current question before proceeding.");
            }
        });

        // Function to submit the assessment (can be called manually or by timer)
        function submitAssessment(isAutoSubmit = false) {
            clearInterval(timerInterval); // Stop the timer

            const userName = userNameInput.value.trim();
            const userEmail = userEmailInput.value.trim();

            if (!userName || !userEmail) {
                showAlert("Please fill in your name and email before submitting.");
                // If this happens on auto-submit, we still want to proceed to score display.
                // If it happens on manual submit, we return.
                if (!isAutoSubmit) return;
            }

            // Check if all questions are answered for manual submission
            if (!isAutoSubmit) {
                // Save the answer for the current (last) question before checking all
                const currentQuestion = questions[currentQuestionIndex];
                const selectedOption = document.querySelector(`input[name="${currentQuestion.name}"]:checked`);
                if (selectedOption) {
                    userAnswers[currentQuestion.name] = selectedOption.value;
                } else {
                    // If the user is on the last question and hasn't answered it, this ensures it's not marked as answered.
                    // If they had an answer and then unselected it, this removes it.
                    delete userAnswers[currentQuestion.name];
                }

                // Check if all questions have an entry in userAnswers
                const allAnswered = questions.every(q => userAnswers.hasOwnProperty(q.name));

                if (!allAnswered) {
                    showAlert("Please answer all questions before submitting.");
                    // Re-enable timer if it was stopped for manual submission attempt
                    if (timeLeft > 0) startTimer(); // Restart timer if there's time left
                    return;
                }
            }

            // If auto-submitted or all questions are answered, proceed with disabling inputs
            const allInputs = assessmentForm.querySelectorAll('input[type="radio"]');
            allInputs.forEach(input => input.disabled = true);
            prevQuestionButton.disabled = true;
            nextQuestionButton.disabled = true;
            submitAssessmentButton.disabled = true;


            let score = 0;
            const totalPossibleScore = questions.length;

            questions.forEach(q => {
                if (userAnswers[q.name] === q.correctAnswer) {
                    score++;
                }
            });

            // Display score
            scoreDisplay.textContent = `${score}/${totalPossibleScore}`;
            assessmentSection.classList.add('hidden');
            scoreResultDiv.classList.remove('hidden');
            scoreResultDiv.classList.add('show'); // Trigger animation

            // Review answers
            answerReview.innerHTML = ''; // Clear previous review
            questions.forEach((q, index) => {
                // Display 'Not answered' if the user did not select an.
                const userAnswer = userAnswers.hasOwnProperty(q.name) ? userAnswers[q.name] : 'Not answered';
                const isCorrect = userAnswer === q.correctAnswer;
                const reviewItem = document.createElement('div');
                // Apply new review item styling
                reviewItem.className = `review-item p-4 rounded-lg ${isCorrect ? 'correct' : 'incorrect'}`;
                reviewItem.innerHTML = `
                    <p class="font-medium" style="color: var(--off-white-text);">${index + 1}. ${q.questionText}</p>
                    <p class="ml-4" style="color: var(--light-grey-text);">Your Answer: <span class="${isCorrect ? 'correct-answer-text' : 'incorrect-answer-text'} font-semibold">${userAnswer}</span></p>
                    <p class="ml-4" style="color: var(--light-grey-text);">Correct Answer: <span class="correct-answer-text font-semibold">${q.correctAnswer}</span></p>
                `;
                answerReview.appendChild(reviewItem);
            });

            // Appreciation popup if score > 59% (i.e., 6 or more correct answers out of 10)
            if (score > (totalPossibleScore * 0.59)) {
                showAlert("Nice progress!");
            }

            // Prepare WhatsApp content
            const trainerPhoneNumber = "8250547520"; // Trainer's WhatsApp number
            let whatsappBody = `Hello Trainer,\n\n`;
            whatsappBody += `This is ${userName}. I have completed the assessment.\n`;
            whatsappBody += `My score is: ${score} out of ${totalPossibleScore}.\n\n`;
            whatsappBody += `Here are my answers:\n\n`;
            questions.forEach((q, index) => {
                whatsappBody += `${index + 1}. ${q.questionText}\n`;
                // Ensure 'Not answered' is correctly reflected in WhatsApp message
                whatsappBody += `   Your answer: ${userAnswers.hasOwnProperty(q.name) ? userAnswers[q.name] : 'Not answered'}\n`;
                whatsappBody += `   Correct answer: ${q.correctAnswer}\n\n`;
            });
            whatsappBody += `Best regards,\n${userName}`;
            const whatsappLink = `https://wa.me/${trainerPhoneNumber}?text=${encodeURIComponent(whatsappBody)}`;

            whatsappTrainerButton.onclick = () => {
                window.open(whatsappLink, '_blank'); // Open WhatsApp link in a new tab
            };

            // Scroll to the result section
            scoreResultDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // Event listener for Submit Assessment button
        submitAssessmentButton.addEventListener('click', (event) => {
            event.preventDefault(); // Prevent default form submission
            submitAssessment(false); // Manual submission
        });

        // Add event listeners for button ripple effect
        document.querySelectorAll('.btn-primary, .btn-secondary').forEach(button => {
            button.addEventListener('click', function(e) {
                // Only create ripple if not disabled
                if (this.disabled) return;

                const rect = this.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;

                const ripple = document.createElement('span');
                ripple.style.left = `${x}px`;
                ripple.style.top = `${y}px`;
                ripple.classList.add('ripple'); // Add a class for styling
                this.appendChild(ripple);

                // Remove the ripple element after the animation
                ripple.addEventListener('animationend', () => {
                    ripple.remove();
                });
            });
        });
    </script>
</body>
</html>
